---
title: "Queue Model- Bed forecasting"
format: html
editor: visual
---

Here are the key assumptions about the stroke ward and below modeling:

There are a total of 16 patients arriving at the ward for different levels of stroke severity. They are as follows:

-   5 patients per day arrive with the **very** **mild** level of stroke. Thus, the $\lambda$ = 5/day or 5/24 and their mean service time is 24 hours. The number of beds available are three (n=3).

```{r}

library(utilities)
library(tidyverse)

# level of severity: very mild
# arrival rate 5/day
# service mean time 24 hours
# number of beds 3

set.seed(2023)

lambda <- 5/24 # avg number of arrivals per day 

K <- 5 # users of the facility

ARRIVE <- cumsum(rexp(K, rate = 1/lambda))

mu <- 24 

use_time <- mu * runif(K)

library(utilities)
QUEUE <- queue(arrive = ARRIVE, use.full = use_time,
                n = 3)

plot(QUEUE)
summary(QUEUE)
```

Patients with the mild level of stroke [typically stay for 5 to 7 days](https://www.hopkinsmedicine.org/health/conditions-and-diseases/stroke/stroke-recovery-timeline#:~:text=The%20typical%20length%20of%20a,will%20determine%20the%20rehabilitation%20plan.), however, some of the patients may get discharged early. Thus, I am making the assumption here that most of the patients stay for 5 to 7 days. I have made up the following scenario:

A total number of patients with the mild level of stroke are 11. Of these 11 patients, 5 patients stay for seven days, 2 for six days, 2 patients for 5 days, 1 patient stays for 4 days and 1 patient for 3 days. Let's make an assumptions these numbers are based on some past experiences, thus hospital wards allocate greater number of beds to patients who are likely to stay for seven days.

-   1 patient arriving per day with **mild** level of stroke is required to stay for 3 days -- $3 \times 24 = 72$ hours:

-   1 patient arriving per day with the **mild** level of stroke that is required to stay in the ward for 4 days -- $4 \times 24 = 96$ hours:

-   2 patient arrive per day with the **mild** level of stroke and are required to stay for 5 days -- $5 \times 24= 120$ hours:

-   2 patient is required to stay for 6 days $6 \times 24=144$ hours:

-   5 patient with the **mild** level of stroke is required to stay for 7 days in the ward. $7 \times 24 = 168$ hours.

```{r}

library(utilities)
library(tidyverse)

# level of severity: mild
# required length of stay: 7 days (7*24) for 5 patients
# arrival rate 11 per day (11/24)
# service mean time for these patients = 7 days (7*24)
# k=5 users staying for seven days
# number of beds allocated 4

set.seed(2023)

lambda1 <- 11/24 # avg number of arrivals per day 

K1 <- 5 # users of the facility

ARRIVE1 <- cumsum(rexp(K1, rate = 1/lambda1))

mu1 <- 168 # 7 x 24=168

use_time1 <- mu1 * runif(K1)

library(utilities)
QUEUE1 <- queue(arrive = ARRIVE1, use.full = use_time1,
                n = 4)

plot(QUEUE1)
summary(QUEUE1)
```

```{r}

# level of severity: mild
# required length of stay: 6 days (6*24) for 2 patients
# arrival rate 11 per day (11/24)
# service mean time for these patients = 6 days (6*24)
# k=2 users staying for six days
# number of beds allocated 1

set.seed(2023)

lambda2 <- 11/24 # avg number of arrivals per day ()

K_p2 <- 2 # users of the facility

ARRIVE2 <- cumsum(rexp(K_p2, rate = 1/lambda2))

mu2 <- 144

use_time2 <- mu2 * runif(K_p2)

library(utilities)
QUEUE_2 <- queue(arrive = ARRIVE2, use.full = use_time2,
                n = 1)

plot(QUEUE_2)
summary(QUEUE_2)
```

```{r}

# level of severity: mild
# required length of stay: 5 days (5*24) for 2 patients
# arrival rate 11 per day (11/24)
# service mean time for these patients = 5 days (5*24)
# k=2 users staying for five days
# number of beds allocated 1

set.seed(2023)

lambda3 <- 11/24 # avg number of arrivals per day ()

K3 <- 2 # users of the facility

ARRIVE3 <- cumsum(rexp(K3, rate = 1/lambda3))

mu3 <- 120 #120 hours 24*5 5 days

use_time3 <- mu3 * runif(K3)

library(utilities)
QUEUE3 <- queue(arrive = ARRIVE3, use.full = use_time3,
                n = 1)

plot(QUEUE3)
summary(QUEUE3)
```

```{r}
# level of severity: mild
# required length of stay: 4 days (7*24) for 1 patient
# arrival rate 11 per day (11/24)
# service mean time for these patients = 4 days (4*24)
# k=5 users staying for seven days
# number of beds allocated 4

set.seed(2023)

lambda4 <- 5/24 # avg number of arrivals per day ()

K4 <- 1 # users of the facility

ARRIVE4 <- cumsum(rexp(K4, rate = 1/lambda4))

mu4 <- 96 # four days

use_time4 <- mu4 * runif(K4)

library(utilities)
QUEUE4 <- queue(arrive = ARRIVE4, use.full = use_time4,
                n = 1)

plot(QUEUE4)
summary(QUEUE4)
```

```{r}
set.seed(2023)

lambda5 <- 11/24 # avg number of arrivals per day ()

K5 <- 1 # users of the facility

ARRIVE5 <- cumsum(rexp(K5, rate = 1/lambda5))

mu5 <- 72 # 72 hours - 3 days - mean service time

use_time5 <- mu5 * runif(K5)

library(utilities)
QUEUE5 <- queue(arrive = ARRIVE5, use.full = use_time5,
                n = 1)

plot(QUEUE5)
summary(QUEUE5)
```

```{r}

```
